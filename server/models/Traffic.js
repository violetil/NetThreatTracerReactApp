// server/models/Traffic.js
const mongoose = require('mongoose');

const TrafficSchema = new mongoose.Schema({
  computerId: {
    type: mongoose.Schema.Types.ObjectId,
    ref: 'Computer',
    required: true
  },
  src_ip: String,
  dst_ip: String,
  src_port: Number,
  dst_port: Number,
  protocol: String,
  flow_duration: Number,
  fwd_packets: Number,
  bwd_packets: Number,
  fwd_bytes: Number,
  bwd_bytes: Number,
  fwd_len_max: Number,
  fwd_len_min: Number,
  fwd_len_mean: Number,
  fwd_len_std: Number,
  bwd_len_max: Number,
  bwd_len_min: Number,
  bwd_len_mean: Number,
  bwd_len_std: Number,
  flow_bytes_per_s: Number,
  flow_packets_per_s: Number,
  fwd_packets_per_s: Number,
  bwd_packets_per_s: Number,
  iat_mean: Number,
  iat_std: Number,
  iat_max: Number,
  iat_min: Number,
  fwd_iat_total: Number,
  fwd_iat_mean: Number,
  fwd_iat_std: Number,
  fwd_iat_max: Number,
  fwd_iat_min: Number,
  bwd_iat_total: Number,
  bwd_iat_mean: Number,
  bwd_iat_std: Number,
  bwd_iat_max: Number,
  bwd_iat_min: Number,
  fwd_psh_flags: Number,
  bwd_psh_flags: Number,
  fwd_urg_flags: Number,
  bwd_urg_flags: Number,
  fwd_header_length: Number,
  bwd_header_length: Number,
  pkt_len_max: Number,
  pkt_len_min: Number,
  pkt_len_mean: Number,
  pkt_len_std: Number,
  pkt_len_var: Number,
  fin_flag_count: Number,
  syn_flag_count: Number,
  rst_flag_count: Number,
  psh_flag_count: Number,
  ack_flag_count: Number,
  urg_flag_count: Number,
  cwe_flag_count: Number,
  ece_flag_count: Number,
  down_up_ratio: Number,
  avg_pkt_size: Number,
  avg_fwd_seg_size: Number,
  avg_bwd_seg_size: Number,
  init_win_bytes_fwd: Number,
  init_win_bytes_bwd: Number,
  act_data_pkt_fwd: Number,
  min_seg_size_fwd: Number,
  active_mean: Number,
  active_std: Number,
  active_max: Number,
  active_min: Number,
  idle_mean: Number,
  idle_std: Number,
  idle_max: Number,
  idle_min: Number,
  fwd_avg_bytes_bulk: Number,
  fwd_avg_packets_bulk: Number,
  fwd_avg_bulk_rate: Number,
  bwd_avg_bytes_bulk: Number,
  bwd_avg_packets_bulk: Number,
  bwd_avg_bulk_rate: Number,
  subflow_fwd_packets: Number,
  subflow_fwd_bytes: Number,
  subflow_bwd_packets: Number,
  subflow_bwd_bytes: Number,
  prediction: String,
});

module.exports = mongoose.model('Traffic', TrafficSchema);
